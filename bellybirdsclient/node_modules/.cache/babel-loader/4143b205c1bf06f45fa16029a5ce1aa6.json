{"ast":null,"code":"import _regeneratorRuntime from\"/Users/saikrishnareddymudhiganti/Desktop/MyProjects/projects/bellybird/bellybirdsclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/saikrishnareddymudhiganti/Desktop/MyProjects/projects/bellybird/bellybirdsclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/saikrishnareddymudhiganti/Desktop/MyProjects/projects/bellybird/bellybirdsclient/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState}from\"react\";import Banner from\"../Banner\";import'./style.scss';import{TextField}from'@material-ui/core';import{useHistory}from\"react-router-dom\";import{Button}from\"@material-ui/core\";import{useButtonStyles,useTextFieldStyles}from\"../../RootStyles\";import{axiosApiCall}from\"../../utility\";import{LOGIN_USER_ENDPOINT}from\"../../endpoints\";import Alerts from\"../Styleguide/Alerts\";import jwt_decode from\"jwt-decode\";import{store}from\"../../redux\";export default function Login(){var buttonclasses=useButtonStyles();var textFieldClasses=useTextFieldStyles();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),text=_useState6[0],setText=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),severity=_useState8[0],setSeverity=_useState8[1];var history=useHistory();function loginUser(){return _loginUser.apply(this,arguments);}function _loginUser(){_loginUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,token,decoded;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosApiCall(LOGIN_USER_ENDPOINT,{email:email,password:password});case 3:response=_context.sent;setSeverity(response.status);setText(response.message);//TODO: bad practice --> refresh tokens\nwindow.localStorage.setItem(\"token\",response.token);if(response.status===\"success\"){history.push(\"/chat\");token=localStorage.getItem(\"token\");decoded=jwt_decode(token);store.dispatch({type:'getUser',user:{email:decoded.email,uname:decoded.username}});}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);setSeverity(\"error\");setText(\"Unexpected Error occured\");case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return _loginUser.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(Banner,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"login__form\",children:[/*#__PURE__*/_jsx(Alerts,{severity:severity,text:text}),/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{className:textFieldClasses.root,noValidate:true,autoComplete:\"off\",children:[/*#__PURE__*/_jsx(TextField,{id:\"filled-basic\",placeholder:\"you@awesome.com\",label:\"Your Email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);},variant:\"outlined\"}),/*#__PURE__*/_jsx(TextField,{id:\"filled-basic\",placeholder:\"p@$$w0rd\",label:\"Your Password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);},variant:\"outlined\"}),/*#__PURE__*/_jsx(Button,{fullWidth:true,className:buttonclasses.secondary,onClick:loginUser,color:\"default\",children:\"Login\"})]})]})]});}","map":{"version":3,"sources":["/Users/saikrishnareddymudhiganti/Desktop/MyProjects/projects/bellybird/bellybirdsclient/src/components/Login/index.tsx"],"names":["React","useState","Banner","TextField","useHistory","Button","useButtonStyles","useTextFieldStyles","axiosApiCall","LOGIN_USER_ENDPOINT","Alerts","jwt_decode","store","Login","buttonclasses","textFieldClasses","email","setEmail","password","setPassword","text","setText","severity","setSeverity","history","loginUser","response","status","message","window","localStorage","setItem","token","push","getItem","decoded","dispatch","type","user","uname","username","root","e","target","value","secondary"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport Banner from \"../Banner\";\nimport './style.scss';\nimport { TextField } from '@material-ui/core';\nimport { useHistory } from \"react-router-dom\";\nimport { Button } from \"@material-ui/core\";\nimport { useButtonStyles, useTextFieldStyles } from \"../../RootStyles\";\nimport { axiosApiCall } from \"../../utility\";\nimport { LOGIN_USER_ENDPOINT } from \"../../endpoints\";\nimport Alerts from \"../Styleguide/Alerts\";\nimport jwt_decode from \"jwt-decode\";\nimport { store } from \"../../redux\";\n\n\nexport default function Login() {\n    const buttonclasses = useButtonStyles();\n    const textFieldClasses = useTextFieldStyles();\n\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [text, setText] = useState(\"\");\n    const [severity, setSeverity] = useState(\"\");\n    const history = useHistory();\n\n    async function loginUser(): Promise<void> {\n        try {\n            const response: any = await axiosApiCall(LOGIN_USER_ENDPOINT, { email, password });\n            setSeverity(response.status);\n            setText(response.message)\n            //TODO: bad practice --> refresh tokens\n            window.localStorage.setItem(\"token\", response.token);\n            if (response.status === \"success\") {\n                history.push(\"/chat\");\n                const token: any = localStorage.getItem(\"token\");\n                const decoded: any = jwt_decode(token)\n                store.dispatch({ type: 'getUser', user: { email: decoded.email, uname: decoded.username } });\n            }\n        } catch (e) {\n            setSeverity(\"error\");\n            setText(\"Unexpected Error occured\");\n        }\n    }\n\n    return (\n        <div className=\"login\">\n            <Banner></Banner>\n                <div className=\"login__form\">\n                    <Alerts severity={severity} text={text}></Alerts>\n                    <h2>Login</h2>\n                    <form className={textFieldClasses.root} noValidate autoComplete=\"off\">\n                        <TextField id=\"filled-basic\" placeholder=\"you@awesome.com\" label=\"Your Email\" value={email} onChange={(e) => setEmail(e.target.value)} variant=\"outlined\" />\n                        <TextField id=\"filled-basic\" placeholder=\"p@$$w0rd\" label=\"Your Password\" value={password} onChange={(e) => setPassword(e.target.value)} variant=\"outlined\" />\n                        <Button fullWidth className={buttonclasses.secondary} onClick={loginUser} color=\"default\" >Login</Button>\n                    </form>\n                </div>\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}